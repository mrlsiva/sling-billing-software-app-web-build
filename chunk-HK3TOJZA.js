import{b as F,d as N,g as A,q as j}from"./chunk-HAJHRD4F.js";import{$ as _,H as o,Ia as T,Ja as I,Na as S,O as h,P,Ra as E,T as f,Ua as V,Xa as z,Y as c,Z as s,_ as i,bb as R,ca as x,da as d,db as D,ea as l,ka as v,ma as g,na as M,oa as b,qa as O,sa as y,ta as w,u as m,ua as k,v as u}from"./chunk-UMG6E2N2.js";function H(r,a){if(r&1){let e=x();s(0,"button",22),d("click",function(){m(e);let t=l(2);return u(t.clearSearch())}),_(1,"i",23),i()}}function L(r,a){if(r&1){let e=x();s(0,"div",17)(1,"div",18),_(2,"i",19),s(3,"input",20),k("ngModelChange",function(t){m(e);let p=l();return w(p.searchTerm,t)||(p.searchTerm=t),u(t)}),d("input",function(){m(e);let t=l();return u(t.onSearch())}),i(),f(4,H,2,0,"button",21),i()()}if(r&2){let e=l();o(3),y("ngModel",e.searchTerm),o(),c("ngIf",e.searchTerm)}}function Y(r,a){r&1&&(s(0,"div",24),g(1,"Loading customers..."),i())}function $(r,a){if(r&1){let e=x();s(0,"div",25),g(1),s(2,"button",26),d("click",function(){m(e);let t=l();return u(t.refreshCustomers())}),g(3,"Try Again"),i()()}if(r&2){let e=l();o(),b(" ",e.error," ")}}function W(r,a){if(r&1&&(s(0,"div",39)(1,"strong"),g(2,"Phone:"),i(),g(3),i()),r&2){let e=l().$implicit;o(3),b(" ",e.phone," ")}}function U(r,a){if(r&1&&(s(0,"div",40)(1,"strong"),g(2,"Address:"),i(),g(3),i()),r&2){let e=l().$implicit;o(3),b(" ",e.address," ")}}function Z(r,a){if(r&1&&(s(0,"article",30)(1,"header",31)(2,"div",32),g(3),i(),s(4,"div",33)(5,"span",34),g(6),i()()(),s(7,"div",35)(8,"div",36),f(9,W,4,1,"div",37)(10,U,4,1,"div",38),i()()()),r&2){let e=a.$implicit;o(3),M(e.name||"-"),o(3),b("#",e.id),o(3),c("ngIf",e.phone),o(),c("ngIf",e.address)}}function q(r,a){if(r&1&&(s(0,"div",27)(1,"div",28),f(2,Z,11,4,"article",29),i()()),r&2){let e=l();o(2),c("ngForOf",e.customers)}}function G(r,a){if(r&1&&(s(0,"div",41),g(1),i()),r&2){let e=l();o(),b(' No customers found matching "',e.searchTerm,'" ')}}function J(r,a){r&1&&(s(0,"div",42),g(1,"No customers found "),i())}function K(r,a){if(r&1){let e=x();s(0,"button",52),d("click",function(){let t=m(e).$implicit,p=l(2);return u(p.goToPage(t))}),g(1),i()}if(r&2){let e=a.$implicit,n=l(2);v("active",e===n.currentPage),o(),b(" ",e," ")}}function Q(r,a){if(r&1){let e=x();s(0,"div",43)(1,"div",44),g(2),i(),s(3,"div",45)(4,"button",46),d("click",function(){m(e);let t=l();return u(t.goToFirstPage())}),_(5,"i",47),i(),s(6,"button",46),d("click",function(){m(e);let t=l();return u(t.previousPage())}),_(7,"i",48),i(),f(8,K,2,3,"button",49),s(9,"button",46),d("click",function(){m(e);let t=l();return u(t.nextPage())}),_(10,"i",50),i(),s(11,"button",46),d("click",function(){m(e);let t=l();return u(t.goToLastPage())}),_(12,"i",51),i()()()}if(r&2){let e=l();o(2),O(" Showing ",e.getStartIndex(),"-",e.getEndIndex()," of ",e.totalItems," customers "),o(2),c("disabled",e.currentPage===1),o(2),c("disabled",e.currentPage===1),o(2),c("ngForOf",e.getPageNumbers()),o(),c("disabled",e.currentPage===e.totalPages),o(2),c("disabled",e.currentPage===e.totalPages)}}var B=class r{constructor(a,e,n){this.http=a;this.auth=e;this.router=n}customers=[];filteredCustomers=[];searchTerm="";loading=!0;error=null;currentPage=1;totalPages=1;itemsPerPage=10;totalItems=0;searchTimeout;Math=Math;ngOnInit(){this.loadCustomers()}ngOnDestroy(){this.searchTimeout&&clearTimeout(this.searchTimeout)}loadCustomers(a=1){this.loading=!0,this.error=null,this.currentPage=a;let e=this.auth.authHeaders(),n={page:a};this.searchTerm.trim()&&(n.search=this.searchTerm.trim()),this.http.get(`${R.apiBase}/customers`,{headers:e,params:n}).subscribe({next:t=>{console.log("Customers API Response:",t),t.success&&t.data?(this.customers=t.data.data,this.currentPage=t.data.current_page,this.totalPages=t.data.last_page,this.itemsPerPage=t.data.per_page,this.totalItems=t.data.total):(this.error=t.message||"Failed to load customers",this.customers=[]),this.loading=!1},error:t=>{console.error("Error loading customers:",t),t.status===401?(this.error="Unauthenticated. Please log in again.",this.auth.clearSession()):t.status===403?this.error="Access denied. You do not have permission to view customers.":t.status===404?this.error="Customers endpoint not found. Please check your configuration.":this.error=t?.error?.message||"Failed to load customers. Please try again.",this.loading=!1}})}onSearch(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.loadCustomers(1)},300)}clearSearch(){this.searchTerm="",this.loadCustomers(1)}refreshCustomers(){this.loadCustomers(this.currentPage)}goBack(){this.router.navigate(["/pos"])}goToPage(a){a>=1&&a<=this.totalPages&&a!==this.currentPage&&this.loadCustomers(a)}goToFirstPage(){this.goToPage(1)}goToLastPage(){this.goToPage(this.totalPages)}nextPage(){this.currentPage<this.totalPages&&this.goToPage(this.currentPage+1)}previousPage(){this.currentPage>1&&this.goToPage(this.currentPage-1)}getPageNumbers(){let a=[],n=Math.floor(2.5),t=Math.max(1,this.currentPage-n),p=Math.min(this.totalPages,this.currentPage+n);p-t+1<5&&(t===1?p=Math.min(this.totalPages,t+5-1):p===this.totalPages&&(t=Math.max(1,p-5+1)));for(let C=t;C<=p;C++)a.push(C);return a}getStartIndex(){return(this.currentPage-1)*this.itemsPerPage+1}getEndIndex(){return Math.min(this.currentPage*this.itemsPerPage,this.totalItems)}static \u0275fac=function(e){return new(e||r)(h(E),h(D),h(z))};static \u0275cmp=P({type:r,selectors:[["app-customers"]],decls:21,vars:10,consts:[[1,"settings-page"],[1,"fixed-header"],[1,"d-flex","space-between"],[1,"fa-solid","fa-users"],[1,"button-group"],[1,"settings-back","p-0",3,"click","disabled"],[1,"fa-solid","fa-refresh"],[1,"settings-back","p-0",3,"click"],[1,"fa-solid","fa-arrow-left"],["class","search-container",4,"ngIf"],[1,"content-container"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],["class","scrollable-grid",4,"ngIf"],["class","no-results",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","fixed-pagination",4,"ngIf"],[1,"search-container"],[1,"search-box"],[1,"fa-solid","fa-search","search-icon"],["type","text","placeholder","Search by name or phone number...",1,"search-input",3,"ngModelChange","input","ngModel"],["class","clear-search",3,"click",4,"ngIf"],[1,"clear-search",3,"click"],[1,"fa-solid","fa-times"],[1,"loading-message"],[1,"error-message"],[1,"btn",3,"click"],[1,"scrollable-grid"],[1,"settings-grid"],["class","settings-card",4,"ngFor","ngForOf"],[1,"settings-card"],[1,"sc-header"],[1,"sc-title"],[1,"sc-sno"],[1,"customer-id"],[1,"sc-body"],[1,"customer-details-row"],["class","sc-row left-col",4,"ngIf"],["class","sc-row right-col",4,"ngIf"],[1,"sc-row","left-col"],[1,"sc-row","right-col"],[1,"no-results"],[1,"empty-state"],[1,"fixed-pagination"],[1,"pagination-info"],[1,"pagination-controls"],[1,"page-btn",3,"click","disabled"],[1,"fa-solid","fa-angles-left"],[1,"fa-solid","fa-chevron-left"],["class","page-btn page-number",3,"active","click",4,"ngFor","ngForOf"],[1,"fa-solid","fa-chevron-right"],[1,"fa-solid","fa-angles-right"],[1,"page-btn","page-number",3,"click"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_(4,"i",3),g(5," Customers"),i(),s(6,"div",4)(7,"button",5),d("click",function(){return n.refreshCustomers()}),_(8,"i",6),g(9," Refresh "),i(),s(10,"button",7),d("click",function(){return n.goBack()}),_(11,"i",8),g(12," Back "),i()()(),f(13,L,5,2,"div",9),i(),s(14,"div",10),f(15,Y,2,0,"div",11)(16,$,4,1,"div",12)(17,q,3,1,"div",13)(18,G,2,1,"div",14)(19,J,2,0,"div",15),i(),f(20,Q,13,8,"div",16),i()),e&2&&(o(7),c("disabled",n.loading),o(),v("spinning",n.loading),o(5),c("ngIf",!n.loading),o(2),c("ngIf",n.loading),o(),c("ngIf",n.error),o(),c("ngIf",n.customers==null?null:n.customers.length),o(),c("ngIf",!(n.customers!=null&&n.customers.length)&&!n.loading&&!n.error&&n.searchTerm),o(),c("ngIf",!(n.customers!=null&&n.customers.length)&&!n.loading&&!n.error&&!n.searchTerm),o(),c("ngIf",n.totalPages>1))},dependencies:[S,T,I,j,F,N,A,V],styles:['.d-flex[_ngcontent-%COMP%]{display:flex;align-items:center}.space-between[_ngcontent-%COMP%]{justify-content:space-between}.settings-back[_ngcontent-%COMP%]{background:none;border:0;color:var(--color-primary-bg);margin-bottom:8px;padding:6px 0}.settings-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-top:8px}.settings-card[_ngcontent-%COMP%]{background:var(--color-neutral-100);border:1px solid var(--color-neutral-400);border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:8px}.sc-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.sc-title[_ngcontent-%COMP%]{font-weight:700}.sc-sno[_ngcontent-%COMP%]{color:var(--color-neutral-600);font-size:.9rem;display:flex;align-items:flex-start;gap:8px}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:999px;font-weight:600;font-size:.85rem}.status-badge.active[_ngcontent-%COMP%]{background:var(--color-secondary-bg);color:var(--color-secondary-text)}.status-badge.inactive[_ngcontent-%COMP%]{background:var(--color-neutral-300);color:var(--color-neutral-600)}.card-toggle[_ngcontent-%COMP%]{margin-left:8px;background:transparent;color:var(--color-primary-bg);padding:4px 6px;border-radius:6px;border:1px solid var(--color-primary-border)}.sc-body[_ngcontent-%COMP%]{font-size:.95rem}.sc-row[_ngcontent-%COMP%]{margin:6px 0}.btn[_ngcontent-%COMP%]{background:var(--color-primary-bg);color:var(--color-primary-text);border:0;padding:6px 10px;border-radius:6px;cursor:pointer}.settings-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.fixed-header[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;z-index:10;padding:12px;border-bottom:1px solid var(--color-neutral-300);box-shadow:0 2px 4px #0000001a}.content-container[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;position:relative}.content-container[_ngcontent-%COMP%]:before, .content-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;right:0;height:20px;pointer-events:none;z-index:5;transition:opacity .3s ease}.content-container[_ngcontent-%COMP%]:before{top:0;background:linear-gradient(to bottom,rgba(255,255,255,.9),transparent);opacity:0}.content-container[_ngcontent-%COMP%]:after{bottom:0;background:linear-gradient(to top,rgba(255,255,255,.9),transparent);opacity:0}.content-container.has-scroll-top[_ngcontent-%COMP%]:before{opacity:1}.content-container.has-scroll-bottom[_ngcontent-%COMP%]:after{opacity:1}.scrollable-grid[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:12px;max-height:calc(100vh - 322px);scrollbar-width:thin;scrollbar-color:var(--color-neutral-400) var(--color-neutral-200);scroll-behavior:smooth;scroll-padding-top:20px;will-change:scroll-position;transform:translateZ(0);-webkit-overflow-scrolling:touch;scroll-snap-type:y proximity}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--color-neutral-100);border-radius:4px;margin:4px 0}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--color-neutral-400);border-radius:4px;transition:background-color .3s ease}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--color-primary-bg)}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:active{background:#e6821a}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:var(--color-neutral-100)}.scrollable-grid[_ngcontent-%COMP%]:focus{outline:2px solid var(--color-primary-bg);outline-offset:-2px}.fixed-pagination[_ngcontent-%COMP%]{position:sticky;bottom:0;background:#fff;z-index:10;border-top:1px solid var(--color-neutral-300);box-shadow:0 -2px 4px #0000001a;display:flex;justify-content:space-between;align-items:center;padding:16px}.loading-message[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:60px 20px;text-align:center;color:var(--color-neutral-600)}h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color-primary-bg)}.p-0[_ngcontent-%COMP%]{padding:0!important}.button-group[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.customer-details-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.settings-card[_ngcontent-%COMP%]{scroll-snap-align:start;transition:transform .2s ease,box-shadow .2s ease}.settings-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001f}.left-col[_ngcontent-%COMP%]{text-align:left}.right-col[_ngcontent-%COMP%]{text-align:right}.search-container[_ngcontent-%COMP%]{margin:12px 0 0;padding-bottom:8px}.search-box[_ngcontent-%COMP%]{position:relative;max-width:400px;width:100%}.search-input[_ngcontent-%COMP%]{width:100%;padding:10px 40px 10px 36px;border:1px solid var(--color-neutral-400);border-radius:8px;font-size:14px;background:#fff;transition:border-color .3s ease;box-sizing:border-box}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary-bg);box-shadow:0 0 0 2px #f8931d1a}.search-input[_ngcontent-%COMP%]::placeholder{color:var(--color-neutral-500)}.search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--color-neutral-500);font-size:14px;pointer-events:none}.clear-search[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--color-neutral-500);cursor:pointer;padding:4px;border-radius:4px;font-size:12px}.clear-search[_ngcontent-%COMP%]:hover{background:var(--color-neutral-200);color:var(--color-neutral-700)}.no-results[_ngcontent-%COMP%]{text-align:center;padding:32px;color:var(--color-neutral-600);font-style:italic}.customer-id[_ngcontent-%COMP%]{font-size:.85rem;color:var(--color-neutral-600)}.error-message[_ngcontent-%COMP%]{padding:16px;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;color:#dc2626;margin:16px 0}.error-message[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-left:12px;background:#dc2626}.error-message[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background:#b91c1c}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px;padding:16px;border-top:1px solid var(--color-neutral-300)}.pagination-info[_ngcontent-%COMP%]{font-size:14px;color:var(--color-neutral-600)}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.page-btn[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--color-neutral-400);background:#fff;color:var(--color-neutral-700);border-radius:6px;cursor:pointer;font-size:14px;transition:all .3s ease;min-width:40px}.page-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-primary-bg);color:#fff;border-color:var(--color-primary-bg)}.page-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:var(--color-neutral-200)}.page-btn.page-number[_ngcontent-%COMP%]{font-weight:500}.page-btn.page-number.active[_ngcontent-%COMP%]{background:var(--color-primary-bg);color:#fff;border-color:var(--color-primary-bg)}.page-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.page-info[_ngcontent-%COMP%]{padding:0 16px;font-size:14px;font-weight:500;color:var(--color-neutral-700)}@media (max-width: 768px){.pagination-container[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.pagination-info[_ngcontent-%COMP%]{order:2}.pagination-controls[_ngcontent-%COMP%]{order:1}.scrollable-grid[_ngcontent-%COMP%]{padding:8px;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.settings-card[_ngcontent-%COMP%]:hover{transform:none;box-shadow:0 2px 8px #00000014}.content-container[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.scrollable-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-image:linear-gradient(45deg,var(--color-primary-bg) 25%,transparent 25%,transparent 75%,var(--color-primary-bg) 75%);background-size:4px 4px}}@media (prefers-reduced-motion: reduce){.scrollable-grid[_ngcontent-%COMP%]{scroll-behavior:auto}.settings-card[_ngcontent-%COMP%]{transition:none}.content-container[_ngcontent-%COMP%]:before, .content-container[_ngcontent-%COMP%]:after{transition:none}}']})};export{B as CustomersComponent};
