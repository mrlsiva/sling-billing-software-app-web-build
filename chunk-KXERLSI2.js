import{a as D}from"./chunk-4AUTOROT.js";import{$ as f,H as a,Ha as S,Ia as I,Ja as P,Na as O,O as c,P as x,Ra as M,T as d,Ua as k,X as b,Xa as E,Y as s,Z as r,_ as n,bb as w,ca as h,da as v,db as T,ea as p,ka as C,ma as l,na as y,oa as g,u,v as _}from"./chunk-UMG6E2N2.js";function j(e,i){e&1&&(r(0,"div"),l(1,"Loading..."),n())}function F(e,i){if(e&1&&(r(0,"div",17)(1,"strong"),l(2,"Phone:"),n(),l(3),n()),e&2){let t=p().$implicit;a(3),g(" ",t.phone)}}function H(e,i){if(e&1&&(r(0,"div",17)(1,"strong"),l(2,"Role:"),n(),l(3),n()),e&2){let t=p().$implicit;a(3),g(" ",t.role)}}function B(e,i){if(e&1){let t=h();r(0,"article",8)(1,"header",9)(2,"div",10),l(3),n(),r(4,"div",11)(5,"span",12),l(6),n(),r(7,"button",13),v("click",function(m){let N=u(t).$implicit,$=p(2);return m.stopPropagation(),_($.toggleItemActive(N))}),f(8,"i",14),n()()(),r(9,"div",15),d(10,F,4,1,"div",16)(11,H,4,1,"div",16),n()()}if(e&2){let t=i.$implicit;a(3),y(t.name||t.full_name||"-"),a(2),C("active",t.is_active===1)("inactive",t.is_active!==1),a(),g(" ",t.is_active===1?"Active":"Inactive"," "),a(),b("aria-pressed",t.is_active===1),a(),s("ngClass",t.is_active===1?"fa-toggle-on":"fa-toggle-off"),a(2),s("ngIf",t.phone),a(),s("ngIf",t.role)}}function R(e,i){if(e&1&&(r(0,"div",6),d(1,B,12,10,"article",7),n()),e&2){let t=p();a(),s("ngForOf",t.items)}}function V(e,i){e&1&&(r(0,"div"),l(1,"No items"),n())}var A=class e{constructor(i,t,o,m){this.http=i;this.auth=t;this.router=o;this.toast=m}items=[];loading=!1;lastUpdated=null;pollTimer=null;pollingEnabled=!0;ngOnInit(){this.load()}ngAfterViewInit(){this.pollingEnabled&&this.startPolling()}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>this.load(!1),1e4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}togglePolling(){this.pollingEnabled=!this.pollingEnabled,this.pollingEnabled?this.startPolling():this.stopPolling()}goBack(){try{this.router.navigate(["/settings"])}catch{history.back()}}ngOnDestroy(){this.stopPolling()}load(i=!0){i&&(this.loading=!0);let t=`${w.apiBase}/staffs`;this.http.get(t,{headers:this.auth.authHeaders()}).subscribe({next:o=>{this.items=o?.data??o,this.loading=!1,this.lastUpdated=new Date},error:o=>{this.loading=!1,this.items=[{id:1,name:"No data Found",email:"nodata@example.com",is_active:1}],this.lastUpdated=new Date}})}toggleItemActive(i){if(!i)return;i.is_active=i.is_active===1?0:1;let t=i.is_active===1?"Active":"Inactive";this.toast.show(`Set ${i.name||i.full_name||"staff"} to ${t}`,"info")}static \u0275fac=function(t){return new(t||e)(c(M),c(T),c(E),c(D))};static \u0275cmp=x({type:e,selectors:[["app-settings-staff"]],decls:10,vars:3,consts:[[1,"settings-page"],[1,"d-flex","space-between"],[1,"settings-back","p-0",3,"click"],[1,"fa-solid","fa-arrow-left"],[4,"ngIf"],["class","settings-grid",4,"ngIf"],[1,"settings-grid"],["class","settings-card",4,"ngFor","ngForOf"],[1,"settings-card"],[1,"sc-header"],[1,"sc-title"],[1,"sc-sno"],[1,"status-badge"],["aria-label","Toggle active",1,"btn","btn-toggle","card-toggle","p-0",3,"click"],[1,"fa-solid",3,"ngClass"],[1,"sc-body"],["class","sc-row",4,"ngIf"],[1,"sc-row"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"h3"),l(3,"Staff"),n(),r(4,"button",2),v("click",function(){return o.goBack()}),f(5,"i",3),l(6," Back"),n()(),d(7,j,2,0,"div",4)(8,R,2,1,"div",5)(9,V,2,0,"div",4),n()),t&2&&(a(7),s("ngIf",o.loading),a(),s("ngIf",o.items==null?null:o.items.length),a(),s("ngIf",!(o.items!=null&&o.items.length)&&!o.loading))},dependencies:[O,S,I,P,k],styles:[".page[_ngcontent-%COMP%]{padding:12px}",".d-flex[_ngcontent-%COMP%]{display:flex;align-items:center}.space-between[_ngcontent-%COMP%]{justify-content:space-between}.settings-back[_ngcontent-%COMP%]{background:none;border:0;color:var(--color-primary-bg);margin-bottom:8px;padding:6px 0}.settings-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-top:8px}.settings-card[_ngcontent-%COMP%]{background:var(--color-neutral-100);border:1px solid var(--color-neutral-400);border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:8px}.sc-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.sc-title[_ngcontent-%COMP%]{font-weight:700}.sc-sno[_ngcontent-%COMP%]{color:var(--color-neutral-600);font-size:.9rem;display:flex;align-items:flex-start;gap:8px}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:999px;font-weight:600;font-size:.85rem}.status-badge.active[_ngcontent-%COMP%]{background:var(--color-secondary-bg);color:var(--color-secondary-text)}.status-badge.inactive[_ngcontent-%COMP%]{background:var(--color-neutral-300);color:var(--color-neutral-600)}.card-toggle[_ngcontent-%COMP%]{margin-left:8px;background:transparent;color:var(--color-primary-bg);padding:4px 6px;border-radius:6px;border:1px solid var(--color-primary-border)}.sc-body[_ngcontent-%COMP%]{font-size:.95rem}.sc-row[_ngcontent-%COMP%]{margin:6px 0}.btn[_ngcontent-%COMP%]{background:var(--color-primary-bg);color:var(--color-primary-text);border:0;padding:6px 10px;border-radius:6px;cursor:pointer}"]})};export{A as StaffComponent};
